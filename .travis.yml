language: rust

rust:
  - stable
  - beta
  - nightly
os:
  - linux
  - osx
before_install:
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get update ; fi
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo apt-get install libwebp-dev ; fi
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew update ; fi
  - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew install webp ; fi
  - wget http://www.imagemagick.org/download/ImageMagick.tar.gz
  - tar xf ImageMagick.tar.gz
  - mkdir /tmp/ImageMagick-lib
  - cd ImageMagick*
  - ./configure --enable-hdri --with-webp
  - make
  - sudo make install
  - if [ "$TRAVIS_OS_NAME" = "linux" ]; then sudo ldconfig ; fi
  - cd ..